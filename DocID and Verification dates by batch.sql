---DocID and Verification dates by batch

select T.BatchName, p.RMN, max(T.DocIDDate) DocIDDate, max(T.VerificationDate) VerificationDate
FROM
(select BatchName, 
case
	when TSModule = 'DocID' then max(timestamp)
	END
	As DocIDDate,
case
	when TSModule = 'Verification' then max(timestamp)
	END
	As VerificationDate
	from TS_Audit where batchname in (
'02150820407001',
'02150820407002',
'02150820407003',
'02150820407004',
'02150820407005',
'02150920805901',
'02150820001201',
'02150820001202',
'02150820001203',
'02150820001204',
'02150930805601',
'02150930805701',
'02150820408001',
'02150820408002',
'02150820408003',
'02150820408004',
'02150930800401',
'02150970003301',
'02150970003302',
'02150970003303',
'02150970003304',
'02150980801201',
'02150930407101',
'02150930407102',
'02150930407103',
'02150930407104',
'02150930407105',
'02150890302301',
'02150890302302',
'02150890302303',
'02150890302304',
'02150890302305',
'02150970404701',
'02150970404702',
'02150970404703',
'02150970404704',
'02150980803001',
'02150970002701',
'02150970002702',
'02150970002703',
'02150970002704',
'02150970002705',
'02150970305201',
'02150970305202',
'02150970305203',
'02150970305204')
and (TSModule = 'DocID' or TSModule = 'Verification')
group by BatchName, TSModule) T
left outer join PhysicalBatch p
on T.BatchName = p.PBatch
group by T.BatchName, p.RMN