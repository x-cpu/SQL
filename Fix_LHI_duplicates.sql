--fix lhi duplicates -- show/find the dups
            select distinct pbatch, ImageID, ftpstime
            from document 
            where imageid in 
            (select imageid 
            from document 
            where ftpstime between '2016-11-01 0:0:0' and '2016-12-20 23:59:59' and PBatch like '14%'
            group by imageid 
            having count(*) > 1) 
            GROUP BY pbatch, ImageID, ftpstime 
			order by ImageID


--fix lhi duplicates - show/find the dups
            select distinct pbatch, ImageID, ftpstime, SysKey
			--into docid.dbo.CandPdfix
            from document 
            where imageid in 
            (select imageid 
            from document 
            where ftpstime between '2016-11-01 0:0:0' and '2016-12-20 23:59:59' and PBatch like '14%'
            group by imageid 
            having count(*) > 1) 
            GROUP BY pbatch, ImageID, ftpstime, SysKey
			order by ImageID


--mark the lhi with max ftpstime
use docid
select * 
FROM
(select distinct imageid, max(ftpstime) ftpstime from candpdfix group by imageid) X
left join candpdfix c
on X.imageid = c.imageid and X.ftpstime = c.ftpstime



--the ones that need fixing
use DOCID
select * from candpdfix where comments is null
order by imageid

use DVA
select * from document where imageid = 'CSRA_LHI_163472914P0010000131'


--fix lhi duplicates
use DVA
            select distinct pbatch, ImageID, ftpstime
            from document 
            where imageid in 
            (select imageid 
            from document 
            where ftpstime between '2016-12-20 0:0:0' and '2016-12-20 23:59:59' and PBatch like '14%'
            group by imageid 
            having count(*) > 1) 
            GROUP BY pbatch, ImageID, ftpstime 
			order by ImageID





----part 2
--update candpdfix
--set comments = 'max'
--where syskey in (
--'98811109',
--'98811110',
--'98811113',
--'98811119',
--'98811120',
--'98811126',
--'98811137',
--'98811139',
--'98811140',
--'98811144',
--'98811146',
--'98811150',
--'98811153',
--'98811154',
--'98811166',
--'98811168',
--'98811174',
--'98811176',
--'98811179',
--'98811181',
--'98811182',
--'98811184',
--'98811194',
--'98811198',
--'98811202',
--'98811204',
--'98811208',
--'98811220',
--'98811221',
--'98811225',
--'98811227',
--'98811229',
--'98811230',
--'98811232',
--'98811233',
--'98811236',
--'98811237',
--'98811238',
--'98811249',
--'98811253',
--'98811256',
--'98811261',
--'98811262',
--'98811264',
--'98811265',
--'98811268',
--'98811275',
--'98811281',
--'98811285',
--'98811294',
--'98811296',
--'98811297',
--'98811300',
--'98811301',
--'98811305',
--'98811310',
--'98811311',
--'98811313',
--'98811318',
--'98811319',
--'98811320',
--'98811323',
--'98811324',
--'98811327',
--'98811329',
--'98811330',
--'98811332',
--'98811334',
--'98811337',
--'98827950',
--'98823397',
--'98827899',
--'98827951',
--'98827952',
--'98827953',
--'98827902',
--'98827954',
--'98827904',
--'98827955',
--'98827956',
--'98827957',
--'98823411',
--'98823413',
--'98827905',
--'98827958',
--'98823415',
--'98827959',
--'98818545',
--'98827906',
--'98827907',
--'98823419',
--'98827908',
--'98827960',
--'98827961',
--'98827962',
--'98827963',
--'98827964',
--'98827966',
--'98827967',
--'98823428',
--'98827968',
--'98827969',
--'98827915',
--'98827970',
--'98827971',
--'98827972',
--'98827973',
--'98827974',
--'98827975',
--'98827921',
--'98827977',
--'98827978',
--'98827979',
--'98827923',
--'98827980',
--'98827981',
--'98827925',
--'98827982',
--'98827927',
--'98827983',
--'98827984',
--'98827930',
--'98827985',
--'98827986',
--'98823448',
--'98827987',
--'98827988',
--'98827989',
--'98827934',
--'98827935',
--'98818588',
--'98827936',
--'98823454',
--'98827937',
--'98827938',
--'98818595',
--'98827939',
--'98818597',
--'98827940',
--'98827943',
--'98827944',
--'98823465',
--'98823466',
--'98827946',
--'98827947',
--'98823470',
--'98827948',
--'98827949',
--'98845125',
--'98845126',
--'98845049',
--'98845050',
--'98845051',
--'98845053',
--'98844979',
--'98842999',
--'98845054',
--'98844981',
--'98845055',
--'98845127',
--'98845057',
--'98845058',
--'98845059',
--'98845060',
--'98845128',
--'98845061',
--'98845129',
--'98845063',
--'98845130',
--'98845131',
--'98844987',
--'98845132',
--'98845066',
--'98844989',
--'98844990',
--'98844991',
--'98845067',
--'98845068',
--'98845069',
--'98845070',
--'98843018',
--'98845071',
--'98844993',
--'98844994',
--'98844995',
--'98845072',
--'98845074',
--'98845075',
--'98845076',
--'98844999',
--'98845078',
--'98845001',
--'98845080',
--'98845003',
--'98845081',
--'98845082',
--'98845083',
--'98845084',
--'98845008',
--'98845085',
--'98845086',
--'98845087',
--'98845088',
--'98845089',
--'98845091',
--'98845092',
--'98845093',
--'98845095',
--'98845096',
--'98845020',
--'98845097',
--'98845098',
--'98845099',
--'98845100',
--'98845101',
--'98845024',
--'98845026',
--'98845102',
--'98845103',
--'98845104',
--'98845030',
--'98845105',
--'98845106',
--'98845107',
--'98845035',
--'98845108',
--'98845037',
--'98845110',
--'98845111',
--'98845112',
--'98845040',
--'98845041',
--'98845114',
--'98845115',
--'98845116',
--'98845117',
--'98845118',
--'98845119',
--'98845120',
--'98845122',
--'98856643',
--'98853800',
--'98856644',
--'98853801',
--'98853802',
--'98856645',
--'98853804',
--'98856646',
--'98856648',
--'98853806',
--'98856649',
--'98856593',
--'98856594',
--'98856650',
--'98856597',
--'98856598',
--'98856651',
--'98856652',
--'98856653',
--'98856654',
--'98856655',
--'98856601',
--'98856656',
--'98856604',
--'98856605',
--'98856606',
--'98856657',
--'98853817',
--'98856658',
--'98856659',
--'98856660',
--'98853820',
--'98856662',
--'98856663',
--'98856665',
--'98856666',
--'98856667',
--'98856612',
--'98856669',
--'98856670',
--'98856614',
--'98856615',
--'98856671',
--'98856672',
--'98856616',
--'98856673',
--'98856617',
--'98856618',
--'98856620',
--'98856674',
--'98856675',
--'98856623',
--'98856624',
--'98856676',
--'98856677',
--'98856678',
--'98856626',
--'98856679',
--'98856628',
--'98856629',
--'98856681',
--'98856682',
--'98856683',
--'98856684',
--'98856685',
--'98856688',
--'98856689',
--'98856690',
--'98856691',
--'98856692',
--'98856693',
--'98856694',
--'98856639',
--'98856695',
--'98856640',
--'98856696',
--'98853843',
--'98856642',
--'98853845',
--'98853847',
--'98872024',
--'98871936',
--'98872025',
--'98872026',
--'98872027',
--'98872029',
--'98871938',
--'98866167',
--'98872030',
--'98872031',
--'98871939',
--'98872032',
--'98871941',
--'98872033',
--'98872035',
--'98871942',
--'98872036',
--'98871944',
--'98866178',
--'98872037',
--'98872038',
--'98872039',
--'98872040',
--'98872041',
--'98872042',
--'98872043',
--'98872044',
--'98866189',
--'98871948',
--'98866191',
--'98872045',
--'98872047',
--'98871949',
--'98872048',
--'98872049',
--'98872050',
--'98871953',
--'98872052',
--'98872053',
--'98871956',
--'98872054',
--'98872055',
--'98872056',
--'98872057',
--'98872058',
--'98872059',
--'98872060',
--'98872061',
--'98872063',
--'98872064',
--'98871962',
--'98872066',
--'98871964',
--'98872071',
--'98872072',
--'98872073',
--'98872074',
--'98872077',
--'98872079',
--'98872080',
--'98872081',
--'98872082',
--'98872083',
--'98872084',
--'98871974',
--'98871975',
--'98871977',
--'98872088',
--'98872090',
--'98872091',
--'98872093',
--'98872095',
--'98872096',
--'98872097',
--'98872098',
--'98872099',
--'98872102',
--'98871985',
--'98872104',
--'98872105',
--'98872106',
--'98872107',
--'98872110',
--'98871991',
--'98871993',
--'98872115',
--'98872116',
--'98872118',
--'98872120',
--'98872121',
--'98872124',
--'98872125',
--'98872126',
--'98872002',
--'98872127',
--'98872130',
--'98872005',
--'98872008',
--'98872010',
--'98872011',
--'98872012',
--'98872013',
--'98872014',
--'98872019',
--'98881123',
--'98891258',
--'98891260',
--'98891261',
--'98890757',
--'98891262',
--'98891263',
--'98890759',
--'98890836',
--'98891264',
--'98890837',
--'98891265',
--'98890838',
--'98890763',
--'98891266',
--'98890839',
--'98891267',
--'98891268',
--'98891269',
--'98890767',
--'98891270',
--'98890768',
--'98891271',
--'98891272',
--'98890771',
--'98890840',
--'98890772',
--'98891274',
--'98891275',
--'98890841',
--'98881146',
--'98891276',
--'98890777',
--'98891277',
--'98891278',
--'98891279',
--'98890780',
--'98891280',
--'98890783',
--'98881153',
--'98891281',
--'98891282',
--'98891283',
--'98890845',
--'98881156',
--'98891284',
--'98890787',
--'98891285',
--'98890789',
--'98890790',
--'98890791',
--'98891287',
--'98891288',
--'98891289',
--'98891290',
--'98891291',
--'98891292',
--'98891293',
--'98890795',
--'98890849',
--'98890796',
--'98881166',
--'98890797',
--'98881168',
--'98890798',
--'98890799',
--'98890850',
--'98890851',
--'98890852',
--'98890853',
--'98890854',
--'98890855',
--'98890804',
--'98890856',
--'98890806',
--'98890857',
--'98890859',
--'98890810',
--'98890861',
--'98890862',
--'98890863',
--'98890864',
--'98890865',
--'98890868',
--'98890821',
--'98890822',
--'98890824',
--'98890869',
--'98890870',
--'98890871',
--'98890872',
--'98890828',
--'98890874',
--'98890875',
--'98890877',
--'98911540',
--'98911541',
--'98911664',
--'98911665',
--'98900167',
--'98911666',
--'98911667',
--'98911668',
--'98911544',
--'98911545',
--'98911546',
--'98911547',
--'98911548',
--'98911550',
--'98911552',
--'98900182',
--'98911554',
--'98911555',
--'98911557',
--'98911558',
--'98911559',
--'98900200',
--'98900203',
--'98911560',
--'98911561',
--'98911562',
--'98911563',
--'98911565',
--'98911566',
--'98911568',
--'98911569',
--'98911570',
--'98911573',
--'98911576',
--'98911577',
--'98911578',
--'98911583',
--'98911584',
--'98911585',
--'98911586',
--'98911587',
--'98911588',
--'98911589',
--'98911590',
--'98911591',
--'98911592',
--'98911593',
--'98911597',
--'98911599',
--'98911600',
--'98911601',
--'98911603',
--'98911605',
--'98911608',
--'98911609',
--'98911611',
--'98911612',
--'98911614',
--'98911615',
--'98911617',
--'98911618',
--'98911619',
--'98911620',
--'98911621',
--'98911623',
--'98911624',
--'98911625',
--'98911626',
--'98911627',
--'98911628',
--'98911629',
--'98911630',
--'98911631',
--'98911634',
--'98911635',
--'98911636',
--'98911637',
--'98911638',
--'98911639',
--'98911640',
--'98911642',
--'98911644',
--'98911645',
--'98911649',
--'98911650',
--'98911652',
--'98911653',
--'98911654',
--'98911655',
--'98911656',
--'98911658',
--'98911659',
--'98911662',
--'98926764',
--'98931999',
--'98932000',
--'98932001',
--'98926549',
--'98926572',
--'98926589',
--'98926598',
--'98932002',
--'98932003',
--'98926908',
--'98932004',
--'98932005',
--'98926942',
--'98926943',
--'98926694',
--'98926380',
--'98932006',
--'98932007',
--'98932008',
--'98932009',
--'98932010',
--'98932011',
--'98932012',
--'98932013',
--'98932014',
--'98932015',
--'98923767',
--'98923773',
--'98932016',
--'98932017',
--'98923800',
--'98923815',
--'98932018',
--'98932019',
--'98923845',
--'98923855',
--'98923856',
--'98923857',
--'98923858',
--'98923859',
--'98923860',
--'98923866',
--'98923886',
--'98923895',
--'98923913',
--'98923923',
--'98923928',
--'98923939',
--'98923955',
--'98923964',
--'98923984',
--'98923996',
--'98924008',
--'98924014',
--'98924023',
--'98923173',
--'98924025',
--'98924026',
--'98924027',
--'98924031',
--'98924044',
--'98924063',
--'98924068',
--'98924080',
--'98924099',
--'98924109',
--'98924119',
--'98924127',
--'98924128',
--'98924129',
--'98924130',
--'98924138',
--'98924144',
--'98924151',
--'98924165',
--'98924182',
--'98924196',
--'98924211',
--'98924222',
--'98924230',
--'98924246',
--'98924259',
--'98924263',
--'98924281',
--'98924287',
--'98924296',
--'98924297',
--'98924298',
--'98924303',
--'98924319',
--'98924334',
--'98924358',
--'98924366',
--'98924381',
--'98924398',
--'98924405',
--'98924419',
--'98924423',
--'98924424',
--'98924425',
--'98924432',
--'98924456',
--'98924470',
--'98924483',
--'98924507',
--'98924518',
--'98924543',
--'98924551',
--'98924559',
--'98924580',
--'98924589',
--'98924590',
--'98924591',
--'98924600',
--'98924626',
--'98924635',
--'98924648',
--'98924666',
--'98924681',
--'98924697',
--'98924701',
--'98924702',
--'98924705',
--'98924733',
--'98924757',
--'98924765',
--'98924785',
--'98924795',
--'98924800',
--'98924811',
--'98924812',
--'98924813',
--'98923005',
--'98924815',
--'98924826',
--'98924834',
--'98924853',
--'98924862',
--'98924869',
--'98924888',
--'98924902',
--'98924919',
--'98924933',
--'98924934',
--'98924935',
--'98924936',
--'98924937',
--'98924949',
--'98924967',
--'98924982',
--'98925005',
--'98923024',
--'98923025',
--'98923027',
--'98922644',
--'98922647',
--'98922650',
--'98922651',
--'98922653',
--'98922658',
--'98922659',
--'98922663',
--'98922666',
--'98922667',
--'98922675',
--'98922677',
--'98922678',
--'98922679',
--'98922683',
--'98922686',
--'98922689',
--'98922692',
--'98922693',
--'98922694',
--'98922696',
--'98922697',
--'98922698',
--'98922699',
--'98922700',
--'98922701',
--'98922702',
--'98922705',
--'98922706',
--'98922707',
--'98922708',
--'98922709',
--'98922710',
--'98922712',
--'98922713',
--'98954546',
--'98954608',
--'98954301',
--'98954549',
--'98954550',
--'98954551',
--'98954552',
--'98954553',
--'98954554',
--'98954555',
--'98954556',
--'98954557',
--'98954558',
--'98954559',
--'98954560',
--'98954561',
--'98954562',
--'98954563',
--'98954564',
--'98954192',
--'98954193',
--'98954194',
--'98954195',
--'98954196',
--'98954197',
--'98954198',
--'98954199',
--'98954200',
--'98954201',
--'98954202',
--'98954203',
--'98954204',
--'98954205',
--'98954206',
--'98954207',
--'98954208',
--'98954209',
--'98954210',
--'98954211',
--'98954212',
--'98954213',
--'98954214',
--'98954215',
--'98954216',
--'98954217',
--'98954218',
--'98954219',
--'98954220',
--'98954221',
--'98954222',
--'98954223',
--'98954224',
--'98954225',
--'98954226',
--'98954227',
--'98954228',
--'98954229',
--'98954230',
--'98954604',
--'98954605',
--'98954606',
--'98954607',
--'98954361',
--'98954643',
--'98954644',
--'98954364',
--'98954645',
--'98954366',
--'98954367',
--'98954368',
--'98954646',
--'98954370',
--'98954647',
--'98954648',
--'98954373',
--'98954649',
--'98954650',
--'98954377',
--'98954651',
--'98954652',
--'98954653',
--'98954654',
--'98954383',
--'98954384',
--'98954385',
--'98954386',
--'98954387',
--'98954388',
--'98954389',
--'98954390',
--'98954391',
--'98954392',
--'98954393',
--'98954394',
--'98954395',
--'98954396',
--'98954398',
--'98954399',
--'98954400',
--'98954401',
--'98954405',
--'98954407',
--'98954408',
--'98954409',
--'98954410',
--'98954411',
--'98954412',
--'98954413',
--'98954414',
--'98954415',
--'98954416',
--'98954418',
--'98954419',
--'98954420',
--'98954421',
--'98954423',
--'98954425',
--'98954427',
--'98954429',
--'98954433',
--'98954434',
--'98954436',
--'98954440',
--'98954444',
--'98954448',
--'98954449',
--'98954454',
--'98954455',
--'98954459',
--'98954460',
--'98954464',
--'98954465',
--'98954467',
--'98954468',
--'98954469',
--'98954472',
--'98954473',
--'98954476',
--'98954482',
--'98954483',
--'98954484',
--'98954485',
--'98954486',
--'98954487',
--'98954488',
--'98954489',
--'98954491',
--'98954492',
--'98954493',
--'98954494',
--'98954495',
--'98954496',
--'98954497',
--'98954499',
--'98954500',
--'98954502',
--'98954504',
--'98954505',
--'98954507',
--'98954508',
--'98954512',
--'98972618',
--'98972619',
--'98972620',
--'98972621',
--'98972622',
--'98972623',
--'98972624',
--'98972625',
--'98972626',
--'98972627',
--'98972628',
--'98972629',
--'98972630',
--'98972631',
--'98972632',
--'98972633',
--'98972634',
--'98972635',
--'98972636',
--'98972637',
--'98972638',
--'98972639',
--'98972640',
--'98972641',
--'98972642',
--'98972643',
--'98972644',
--'98972645',
--'98972646',
--'98972647',
--'98972648',
--'98972649',
--'98972650',
--'98972651',
--'98972652',
--'98972653',
--'98972654',
--'98972655',
--'98972656',
--'98972657',
--'98972658',
--'98972659',
--'98972931',
--'98972932',
--'98972933',
--'98972934',
--'98972935',
--'98972936',
--'98972937',
--'98972938',
--'98972939',
--'98972940',
--'98972941',
--'98972942',
--'98972943',
--'98972944',
--'98972945',
--'98972946',
--'98972947',
--'98972948',
--'98972949',
--'98972950',
--'98972951',
--'98972952',
--'98972953',
--'98972954',
--'98972955',
--'98972956',
--'98972957',
--'98972958',
--'98972959',
--'98972960',
--'98972961',
--'98972962',
--'98972963',
--'98972964',
--'98972965',
--'98972966',
--'98972967',
--'98972968',
--'98972969',
--'98972970',
--'98972971',
--'98972972',
--'98972811',
--'98972812',
--'98972814',
--'98972815',
--'98972817',
--'98972818',
--'98972820',
--'98972821',
--'98972822',
--'98972823',
--'98972825',
--'98972826',
--'98972827',
--'98972828',
--'98972522',
--'98972831',
--'98972833',
--'98972834',
--'98972836',
--'98972837',
--'98972838',
--'98972839',
--'98972840',
--'98972844',
--'98972845',
--'98972846',
--'98972847',
--'98972849',
--'98972850',
--'98972852',
--'98972854',
--'98972855',
--'98972856',
--'98972857',
--'98972860',
--'98972863',
--'98972864',
--'98972866',
--'98972867',
--'98972868',
--'98972869',
--'98972870',
--'98972871',
--'98972873',
--'98972874',
--'98972875',
--'98972876',
--'98972877',
--'98972878',
--'98972880',
--'98972881',
--'98972882',
--'98972883',
--'98972885',
--'98972887',
--'98972888',
--'98972551',
--'98972552',
--'98972555',
--'98972556',
--'98972557',
--'98972558',
--'98972563',
--'98972564',
--'98972566',
--'98972567',
--'98972571',
--'98972574',
--'98972576',
--'98972578',
--'98972579',
--'98972583',
--'98972585',
--'98972586',
--'98985344',
--'98985345',
--'98985346',
--'98985028',
--'98981078',
--'98985029',
--'98985030',
--'98985031',
--'98985032',
--'98985348',
--'98985349',
--'98985350',
--'98985351',
--'98985352',
--'98985353',
--'98981086',
--'98985038',
--'98985354',
--'98985355',
--'98985041',
--'98985356',
--'98985357',
--'98985358',
--'98985359',
--'98985360',
--'98981091',
--'98985361',
--'98985362',
--'98985046',
--'98985363',
--'98985364',
--'98985048',
--'98985365',
--'98985366',
--'98985368',
--'98985369',
--'98985054',
--'98985056',
--'98985370',
--'98985371',
--'98985372',
--'98985373',
--'98985375',
--'98985063',
--'98985064',
--'98985065',
--'98985066',
--'98985067',
--'98985069',
--'98985071',
--'98985073',
--'98985074',
--'98985076',
--'98985078',
--'98985086',
--'98985093',
--'98985096',
--'98985097',
--'98996364',
--'98996424',
--'98994157',
--'98996366',
--'98996425',
--'98996368',
--'98994161',
--'98994162',
--'98996426',
--'98996427',
--'98996370',
--'98996428',
--'98996429',
--'98996430',
--'98996372',
--'98996431',
--'98996373',
--'98994169',
--'98996374',
--'98996375',
--'98996376',
--'98996377',
--'98988802',
--'98996378',
--'98988805',
--'98994171',
--'98994172',
--'98996379',
--'98996380',
--'98996381',
--'98996382',
--'98996384',
--'98994177',
--'98996385',
--'98996389',
--'98996394',
--'98996396',
--'98996397',
--'98996398',
--'98996399',
--'98996401',
--'98996402',
--'98996404',
--'98996406',
--'98996410',
--'98996412',
--'98996415',
--'98996416',
--'98996419',
--'98996420',
--'98996421',
--'98996422',
--'98996423',
--'99006827',
--'99006828',
--'99006829',
--'99006831',
--'99006832',
--'99006765',
--'99006833',
--'99006766',
--'99006834',
--'99006835',
--'99006836',
--'99006837',
--'99006838',
--'99006839',
--'99006774',
--'99006840',
--'99004676',
--'99006842',
--'99006843',
--'99006844',
--'99006845',
--'99006846',
--'99006847',
--'99004679',
--'99006848',
--'99006782',
--'99006849',
--'99006850',
--'99006784',
--'99006852',
--'99006853',
--'99006854',
--'99006855',
--'99006856',
--'99006857',
--'99006858',
--'99006859',
--'99006792',
--'99006860',
--'99006793',
--'99006861',
--'99006794',
--'99006795',
--'99006797',
--'99004695',
--'99006798',
--'99006799',
--'99004699',
--'99006800',
--'99006801',
--'99006802',
--'99006803',
--'99006806',
--'99006807',
--'99006809',
--'99006811',
--'99006812',
--'99006813',
--'99006814',
--'99006816',
--'99004712',
--'99006817',
--'99004714',
--'99004715',
--'99006818',
--'99006820',
--'99006822',
--'99004716',
--'99006823',
--'99006825',
--'99006826')



use DOCID
select * from candpdfix where imageid in (
'CSRA_LHI_163362914P0010000001',
'CSRA_LHI_163362914P0010000002',
'CSRA_LHI_163362914P0010000007',
'CSRA_LHI_163362914P0010000012')






			select * from document where pbatch like '14%' and ImageDateTime >= '2016-12-19 0:0:0'
			select * from document where pbatch like '14163550000001'
			select * from document where imageid = 'CSRA_CMP_163022902P001007221'



			select * from domaCMPxmldownload where batchname = '20161216040354101'
			select * from pmrImageIDMapping where batchname = '20161216040354101'


			select * from domaCMPxmldownload where batchname = '20161216040354408'
			select * from pmrImageIDMapping where batchname = '20161216040354408'