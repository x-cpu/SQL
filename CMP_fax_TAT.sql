select distinct d.PBatch, 
max(p.InvTime) BatchCreationDateTime, 
max(imagedatetime) ExportDateTime, 
max(acktime) DMHSAckTime,
--DATEDIFF(HOUR, max(p.InvTime), max(acktime))/24.00  TATBasedOn_CreationDateTime_DMHSAckTime
CAST(DATEDIFF(HOUR, max(p.InvTime), max(acktime))/24.00 as decimal(5,2)) TATBasedOn_BatchCreationDateTime_DMHSAckTime
--DATEDIFF(SECOND, max(p.InvTime), max(acktime))/86400.00  TATBasedOn_CreationDateTime_DMHSAckTime
from document d
left join smsDCSMapping s
on d.PBatch = s.batchname
left join PhysicalBatch p
on d.PBatch = p.PBatch
where d.PBatch in (
'04181620016701',
'04181620019501',
'04181620016801',
'04181620016901',
'04181620017001',
'04181620019601',
'04181620017101',
'04181620017201',
'04181620017301',
'04181620017401',
'04181620019701',
'04181620017501',
'04181620017601',
'04181620017701',
'04181620019801',
'04181620017801',
'04181620017901',
'04181620018001',
'04181620018101',
'04181620019901',
'04181620018201',
'04181620018301',
'04181620018401',
'04181620018501',
'04181620018601',
'04181620020001',
'04181620018701',
'04181620018901',
'04181620019001',
'04181620020101',
'04181620019101',
'04181620019301',
'04181620020201',
'04181620020301',
'04181620020401',
'04181620019401',
'04181620020501',
'04181630000501',
'04181630000601',
'04181630000701',
'04181630000101',
'04181630000201')
group by d.PBatch




